| Zaafiyetler                                    | Zaafiyet Açıklamaları                                           | Zaafiyetli Kod Örneği                                                                                 | Önleme Fonksiyonları / İşlemler                                                                                        | Önlenmiş Kod Örneği                                                                                                                                                                |
|------------------------------------------------|-----------------------------------------------------------------|--------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| OS Command Injection                           | Saldırganın sunucuda işletim sistemi komutlarını çalıştırabilmesi. | $output = shell_exec("cat " . $_GET['filename']);                                                      | escapeshellarg() veya escapeshellcmd()                                                                               | $userInput = $_GET['filename']; $escapedInput = escapeshellarg($userInput); $output = shell_exec("cat " . $escapedInput);                                                        |
| SQL Injection                                  | Saldırganın SQL sorgularını manipüle edebilmesi.                  | $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ' . $_POST['email']);                       | PDO::prepare() ve PDOStatement::bindParam()                                                                          | $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?'); $stmt->execute([$_POST['email']]);                                                                                    |
| Cross-Site Scripting (XSS)                     | Saldırganın kullanıcı tarayıcısında keyfi JavaScript kodlarını çalıştırabilmesi.                  | echo "Hello, " . $_POST['username'];                                                                  | htmlspecialchars()                                                                                                   | $userInput = $_POST['username']; $safeInput = htmlspecialchars($userInput, ENT_QUOTES, 'UTF-8'); echo "Hello, " . $safeInput;                                                       |
| Local File Inclusion (LFI)                     | Saldırganın sunucuda keyfi dosyaları okuyabilmesi.                | include($_GET['filename'] . ".php");                                                                  | in_array()                                                                                                           | $allowed_pages = ['home', 'about', 'contact']; $page = $_GET['page']; if (!in_array($page, $allowed_pages)) { die("Not allowed"); } include($page . ".php");                    |
| Remote File Inclusion (RFI)                    | Saldırganın sunucuda dış kaynaklardan dosyaları dahil edebilmesi. | include($_GET['filename'] . ".php");                                                                  | PHP .ini dosyasında allow_url_include ayarını Off olarak ayarlamak.                                                 | PHP .ini dosyasında allow_url_include ayarını Off olarak ayarlayın.                                                                                                                  |
| Unrestricted File Upload                       | Saldırganın sunucuya zararlı dosyalar yükleyebilmesi.             | move_uploaded_file($_FILES['userfile']['tmp_name'], '/path/' . $_FILES['userfile']['name']);         | pathinfo() ve in_array()                                                                                             | $allowedExtensions = ['jpg', 'png', 'gif']; $fileName = $_FILES['userfile']['name']; $ext = pathinfo($fileName, PATHINFO_EXTENSION); if (!in_array($ext, $allowedExtensions)) { die("Not allowed file extension"); } move_uploaded_file($_FILES['userfile']['tmp_name'], '/safe/path/' . $fileName); |
| Broken Authentication                          | Saldırganın yetkisiz şekilde başka bir kullanıcının oturumuna girebilmesi. | $hashed_password = md5($_POST['password']);                                                        | password_hash() ve password_verify()                                                                                  | $hashed_password = password_hash($_POST['password'], PASSWORD_DEFAULT); // Save the hashed password into database, and then during login use password_verify() for checking.     |
| Cross-Site Request Forgery (CSRF)              | Saldırganın kurbanın tarayıcısında istem dışı istekler göndermesini sağlar. | Form gönderimi veya AJAX isteği                                                                 | CSRF tokenleri kullanmak                                                                                              | PHP'de hash_hmac() veya çeşitli frameworklerin sağladığı CSRF korumasını kullanmak.                                                                                                 |
| Server-Side Request Forgery (SSRF)             | Saldırganın iç ağdaki veya dışarıdaki sistemlere istekler göndermesine izin verir. | $response = file_get_contents($_GET['url']);                                                      | Gelen URL'lerin doğrulanması ve kontrollü ağ erişimi                                                                   | Kontrol edilmiş beyaz liste veya regex ile belirli URL'leri izin vermek.                                                                                                             |
| PHP Code Injection                             | Saldırganın PHP kodunu çalıştırmasını sağlar.                     | eval($_GET['code']);                                                                                  | eval() kullanmamak                                                                                                   | eval() kullanmanın yerine güvenli alternatifler kullanmak, örneğin preg_replace()                                                                                                   |
| Cross-Origin Resource Sharing (CORS)           | Saldırganın farklı bir kökenden (origin) bir kaynağa erişmesini sağlar. | Header'da yanlışlıkla "*" izni vermek                                                               | Doğru CORS politikalarının uygulanması                                                                                  | Herkese açık olmayan endpointler için belirli kökenlere izin vermek.                                                                                                                  |
| XML External Entity (XXE) Attack               | Saldırganın dış XML varlıklarını kullanarak bilgi sızdırması.      | $xml = simplexml_load_string($_POST['xmlData']);                                                     | libxml_disable_entity_loader(true);                                                                                    | $xml = libxml_disable_entity_loader(true); simplexml_load_string($_POST['xmlData']);                                                                                               |
| Insecure Direct Object References (IDOR)        | Kullanıcıların yetkileri olmadan diğer kullanıcıların verilerine erişebilmesi. | $requested_id = $_GET['id'];                                                                     | Yetki kontrolü                                                                                                       | $user_id = $_SESSION['user_id']; $requested_id = $_GET['id']; if ($user_id !== $requested_id) { die("You are not allowed to access this data."); }                               |
| Security Misconfiguration                      | Yapılandırma hatalarından kaynaklanan güvenlik zaafiyetleri.      | ini_set('display_errors', '1');                                                                      | Hataların sadece log dosyalarında saklanması                                                                            | ini_set('display_errors', '0');                                                                                                                                                     |
| Insecure Deserialization                       | Saldırganın, serileştirilmiş veriyi değiştirerek uygulamanın normal davranışını değiştirebilmesi. | $data = unserialize($_POST['data']);                                                                | Güvenli de-serileştirme işlemi                                                                                         | $data = json_decode($_POST['data']);                                                                                                                                                |
| Path Traversal                                 | Saldırganın dosya sistemini gezinerek yetkisi olmayan dosyaları okuması veya değiştirmesi.           | $file = $_GET['file']; include($file . '.php');                                                     | Dosya isimlerinde manipülasyonu önlemek                                                                                 | $filename = basename($_GET['filename']); $path = '/safe/path/' . $filename; if (!file_exists($path)) { die("File not found"); }                                                     |
| Header Injection                               | Saldırganın HTTP başlıklarını manipüle ederek uygulama davranışını değiştirmesi veya kullanıcıları hedef alması. | header('Location: ' . $_GET['url']);                                                         | Header değerlerinin süzülmesi                                                                                          | $user_agent = str_replace(["\n","\r"], '', $_SERVER['HTTP_USER_AGENT']); header("User-Agent: $user_agent");                                                                     |
| Clickjacking (User Interface redress attack)   | Saldırganın, kullanıcıyı kandırarak farkında olmadan zararlı işlemler gerçekleştirmesi. | header('X-Frame-Options: SAMEORIGIN');                                                            | X-Frame-Options başlığının kullanılması                                                                                  | header('X-Frame-Options: DENY');                                                                                                                                                     |
| HTTP Verb Tampering                            | Saldırganın HTTP istek metoduyla oynayarak yetkisi olmayan işlemler gerçekleştirebilmesi. | if ($_SERVER['REQUEST_METHOD'] === 'GET') { ... }                                                   | İstek metodlarının kontrolü                                                                                            | if ($_SERVER['REQUEST_METHOD'] !== 'POST') { exit; }                                                                                                                                |
| HTTP Parameter Pollution (HPP)                 | Saldırganın aynı parametreyi birden çok kez göndererek uygulama davranışını değiştirmesi.           | $_GET['id']                                                                                         | Tekil parametreler kullanma                                                                                            | $id = $_GET['id'];                                                                                                                                                                 |
| Missing Encryption of Sensitive Data            | Hassas verilerin açıkta bırakılması.                               | $_POST['password']                                                                                   | Verinin şifrelenmesi                                                                                                  | $password_hash = password_hash($password, PASSWORD_DEFAULT);                                                                                                                       |
| Insufficient Logging & Monitoring              | Uygulamada yapılan işlemlerin kaydının tutulmaması veya yetersiz olması. | -                                                                                                   | Hataların ve olayların kaydedilmesi                                                                                     | error_log('Error or exception message');                                                                                                                                           |
| Sensitive Data Exposure                        | Hassas verinin istem dışı sızdırılması.                            | define('DB_PASSWORD', 'mysecretpassword');                                                          | Ortam değişkenlerinin kullanılması                                                                                      | $db_password = getenv('DB_PASSWORD');                                                                                                                                               |
| Insufficient Session Expiration                 | Oturumların zamanında sona ermemesi.                                | -                                                                                                   | Oturum süresinin belirlenmesi                                                                                           | ini_set('session.cookie_lifetime', 600);                                                                                                                                           |
| Unvalidated Redirects and Forwards             | Kullanıcıların kontrolsüz yönlendirilmeleri.                       | header('Location: ' . $_GET['url']);                                                               | Yönlendirilecek URL'lerin doğrulanması                                                                                   | $allowed_urls = ['https://www.yourwebsite.com', 'https://yourwebsite.com/login']; if (!in_array($_GET['redirect'], $allowed_urls)) { die('Invalid redirect URL'); }                 |
