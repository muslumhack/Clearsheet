| Zaafiyetler | Zaafiyet Açıklamaları | Zaafiyetli Kod Örneği | Önleme Fonksiyonları / İşlemler | Önlenmiş Kod Örneği |
| --- | --- | --- | --- | --- |
| Cross-Site Scripting (XSS) | Saldırganın istemcinin tarayıcısında çalıştırılabilir kodu enjekte edebilmesi. | `document.write("Hello, " + userInput);` | HTML özel karakterlerini kaçış işlemi | `document.write("Hello, " + encodeURI(userInput));` |
| JSON Hijacking (XSSI) | Saldırganın JSONP yanıtlarını çalabilmesi. | `response.json()` | JSON yanıtlarını CORS ile koruma | `response.json().then(data => { if (response.headers.get('Content-Type') === 'application/json' && response.ok) {...}})` |
| Node.js OS Command Injection | Saldırganın işletim sistemi komutlarını Node.js uygulamasına enjekte edebilmesi. | `require('child_process').exec('ls ' + userInput, callback);` | Kullanıcı girişini doğrulama | `require('child_process').exec('ls ' + encodeURI(userInput), callback);` |
| NoSQL Injection | Saldırganın NoSQL sorgularını manipüle ederek veritabanına erişebilmesi. | `db.collection.find({ username: req.body.username })` | Sorgu parametrelerini doğrulama | `db.collection.find({ username: sanitize(req.body.username) })` |
| Regular Expression Denial of Service (ReDoS) | Saldırganın regex işlemi nedeniyle uygulamayı aşırı yükleyebilmesi. | `new RegExp('^' + userInput + '$').test('hello')` | Kullanıcı girişli regex kullanmaktan kaçınma | `new RegExp('^[a-zA-Z0-9]+$').test(userInput)` |
| Insecure Direct Object References (IDOR) | Saldırganın yetkisiz olarak başka bir kullanıcının verilerine erişebilmesi. | `fetch('/api/users/' + userId)` | Yetkilendirmeyi sağlama | `if (authUser.id === userId) { fetch('/api/users/' + userId) }` |
| Same Origin Policy Violation | Kaynakların aynı kökene ait olmayan başka bir kökene erişebilmesi. | `window.postMessage(data, '*');` | Hedef kökeni belirtme | `window.postMessage(data, 'http://example.com');` |
| Cross-Site Request Forgery (CSRF) | Saldırganın kullanıcının tarayıcısını kullanarak uygulamaya istem dışı istekler göndermesi. | `fetch('/api/changeEmail', { method: 'POST', body: newEmail })` | Anti-CSRF token kullanma | `fetch('/api/changeEmail', { method: 'POST', body: { newEmail, csrfToken } })` |
| Server Side JavaScript Injection (SSJI) | Saldırganın sunucu tarafındaki JavaScript koduna kötü niyetli komutlar enjekte edebilmesi. | `eval(req.body.code)` | `eval()` fonksiyonunu kullanmamak | `// Avoid using eval()` |
| Prototype Pollution | Saldırganın JavaScript prototiplerini değiştirerek bir uygulamanın beklenmeyen şekillerde davranmasına sebep olabilmesi. | `_.merge({}, userInput)` | Güvenli olmayan fonksiyonları kullanmaktan kaçınma | `Object.assign({}, userInput)` |
| Insecure Randomness | Saldırganın tahmin edilebilir rastgele değerler sayesinde bir uygulamanın davranışını tahmin edebilmesi. | `Math.random()` | Kripto-güvenli rastgele değerler oluşturma | `crypto.randomBytes(size)` |
| Event Handler Hijacking | Saldırganın kötü niyetli kodu bir DOM olay işleyicisine ekleyerek kullanıcı etkileşimlerini kontrol edebilmesi. | `element.onclick = new Function(userInput);` | Kullanıcı girişiyle oluşturulan işleyicilerden kaçınma | `element.addEventListener('click', function() { /* Safe code */ });` |
